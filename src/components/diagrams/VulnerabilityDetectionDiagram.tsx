
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";

const VulnerabilityDetectionDiagram = () => {
  return (
    <Card className="w-full">
      <CardHeader>
        <CardTitle className="text-lg">Activity Diagram 3: Vulnerability Detection Workflow</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          <svg viewBox="0 0 650 500" className="w-full h-auto border rounded">
            {/* Start Node */}
            <circle cx="50" cy="40" r="15" fill="#4ade80" stroke="#16a34a" strokeWidth="2"/>
            <text x="50" y="45" textAnchor="middle" className="text-xs font-medium">Start</text>
            
            {/* Load Target */}
            <rect x="20" y="80" width="60" height="25" fill="#e5e7eb" stroke="#6b7280" strokeWidth="1" rx="3"/>
            <text x="50" y="97" textAnchor="middle" className="text-xs">Load Target</text>
            
            {/* Static Analysis */}
            <rect x="140" y="80" width="80" height="25" fill="#dbeafe" stroke="#3b82f6" strokeWidth="1" rx="3"/>
            <text x="180" y="97" textAnchor="middle" className="text-xs">Static Analysis</text>
            
            {/* Dynamic Analysis */}
            <rect x="270" y="80" width="80" height="25" fill="#dbeafe" stroke="#3b82f6" strokeWidth="1" rx="3"/>
            <text x="310" y="97" textAnchor="middle" className="text-xs">Dynamic Analysis</text>
            
            {/* Behavioral Analysis */}
            <rect x="400" y="80" width="80" height="25" fill="#dbeafe" stroke="#3b82f6" strokeWidth="1" rx="3"/>
            <text x="440" y="97" textAnchor="middle" className="text-xs">Behavioral</text>
            
            {/* Code Pattern Check */}
            <rect x="120" y="140" width="80" height="25" fill="#fef3c7" stroke="#f59e0b" strokeWidth="1" rx="3"/>
            <text x="160" y="157" textAnchor="middle" className="text-xs">Code Patterns</text>
            
            {/* Runtime Analysis */}
            <rect x="250" y="140" width="80" height="25" fill="#fef3c7" stroke="#f59e0b" strokeWidth="1" rx="3"/>
            <text x="290" y="157" textAnchor="middle" className="text-xs">Runtime Check</text>
            
            {/* Traffic Analysis */}
            <rect x="380" y="140" width="80" height="25" fill="#fef3c7" stroke="#f59e0b" strokeWidth="1" rx="3"/>
            <text x="420" y="157" textAnchor="middle" className="text-xs">Traffic Analysis</text>
            
            {/* CVE Database Check */}
            <rect x="200" y="200" width="100" height="25" fill="#f3e8ff" stroke="#8b5cf6" strokeWidth="1" rx="3"/>
            <text x="250" y="217" textAnchor="middle" className="text-xs">CVE Database</text>
            
            {/* Severity Assessment */}
            <polygon points="230,260 270,240 310,260 270,280" fill="#fecaca" stroke="#dc2626" strokeWidth="1"/>
            <text x="270" y="265" textAnchor="middle" className="text-xs">Assess</text>
            
            {/* Critical Path */}
            <rect x="380" y="240" width="80" height="25" fill="#fecaca" stroke="#dc2626" strokeWidth="1" rx="3"/>
            <text x="420" y="257" textAnchor="middle" className="text-xs">Critical Alert</text>
            
            {/* High Priority */}
            <rect x="380" y="290" width="80" height="25" fill="#fed7aa" stroke="#ea580c" strokeWidth="1" rx="3"/>
            <text x="420" y="307" textAnchor="middle" className="text-xs">High Priority</text>
            
            {/* Medium Priority */}
            <rect x="380" y="340" width="80" height="25" fill="#fef3c7" stroke="#f59e0b" strokeWidth="1" rx="3"/>
            <text x="420" y="357" textAnchor="middle" className="text-xs">Medium</text>
            
            {/* Low Priority */}
            <rect x="380" y="390" width="80" height="25" fill="#dbeafe" stroke="#3b82f6" strokeWidth="1" rx="3"/>
            <text x="420" y="407" textAnchor="middle" className="text-xs">Low Priority</text>
            
            {/* Generate ID */}
            <rect x="200" y="340" width="80" height="25" fill="#dcfce7" stroke="#16a34a" strokeWidth="1" rx="3"/>
            <text x="240" y="357" textAnchor="middle" className="text-xs">Generate ID</text>
            
            {/* Log Vulnerability */}
            <rect x="200" y="390" width="80" height="25" fill="#dcfce7" stroke="#16a34a" strokeWidth="1" rx="3"/>
            <text x="240" y="407" textAnchor="middle" className="text-xs">Log Vuln</text>
            
            {/* End Node */}
            <circle cx="240" cy="450" r="15" fill="#ef4444" stroke="#dc2626" strokeWidth="2"/>
            <text x="240" y="455" textAnchor="middle" className="text-xs font-medium">End</text>
            
            {/* Arrows */}
            <defs>
              <marker id="arrow3" markerWidth="8" markerHeight="6" 
               refX="0" refY="3" orient="auto">
                <polygon points="0 0, 8 3, 0 6" fill="#6b7280" />
              </marker>
            </defs>
            
            {/* Main flow */}
            <line x1="50" y1="55" x2="50" y2="80" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="80" y1="92" x2="140" y2="92" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="220" y1="92" x2="270" y2="92" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="350" y1="92" x2="400" y2="92" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Analysis flows */}
            <line x1="180" y1="105" x2="160" y2="140" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="310" y1="105" x2="290" y2="140" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="440" y1="105" x2="420" y2="140" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* CVE check convergence */}
            <line x1="160" y1="165" x2="200" y2="200" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="290" y1="165" x2="250" y2="200" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="420" y1="165" x2="300" y2="200" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Assessment flow */}
            <line x1="250" y1="225" x2="270" y2="240" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Severity paths */}
            <line x1="310" y1="252" x2="380" y2="252" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="310" y1="260" x2="380" y2="302" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="310" y1="268" x2="380" y2="352" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="310" y1="275" x2="380" y2="402" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Convergence to ID generation */}
            <line x1="380" y1="252" x2="320" y2="340" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="380" y1="302" x2="320" y2="340" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="380" y1="352" x2="280" y2="352" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="380" y1="402" x2="280" y2="390" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Final flow */}
            <line x1="240" y1="365" x2="240" y2="390" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            <line x1="240" y1="415" x2="240" y2="435" stroke="#6b7280" strokeWidth="1" markerEnd="url(#arrow3)"/>
            
            {/* Labels */}
            <text x="330" y="247" className="text-xs fill-red-600">Critical</text>
            <text x="330" y="297" className="text-xs fill-orange-600">High</text>
            <text x="330" y="347" className="text-xs fill-yellow-600">Medium</text>
            <text x="330" y="397" className="text-xs fill-blue-600">Low</text>
          </svg>
        </div>
      </CardContent>
    </Card>
  );
};

export default VulnerabilityDetectionDiagram;
